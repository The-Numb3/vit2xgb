#!/usr/bin/env python3
"""
ì¤‘ë³µ ì œê±°ëœ ë°ì´í„°ì˜ K-fold êµì°¨ê²€ì¦ ê²°ê³¼ ìš”ì•½
"""

import pandas as pd
import numpy as np

def main():
    print("=== ì¤‘ë³µ ì œê±°ëœ ë°ì´í„° K-fold êµì°¨ê²€ì¦ ê²°ê³¼ ìš”ì•½ ===\n")
    
    # ê²°ê³¼ ë°ì´í„° (kfold_xgb_eval.py ì‹¤í–‰ ê²°ê³¼)
    results = {
        'Target': ['Marbling', 'Total', 'Meat Color', 'Texture', 'Surface Moisture'],
        'MAE_mean': [0.6133, 0.6467, 0.6533, 0.6667, 0.5333],
        'MAE_std': [0.0909, 0.0452, 0.0618, 0.0471, 0.0558],
        'R2_mean': [-0.0169, -0.1398, -0.0547, -0.0466, -0.1266],
        'R2_std': [0.1420, 0.1742, 0.2824, 0.0993, 0.0606],
        'ACC_mean': [0.4800, 0.4533, 0.4467, 0.4067, 0.4733],
        'ACC_std': [0.0581, 0.0499, 0.0542, 0.0712, 0.0611],
        'F1_mean': [0.1782, 0.1962, 0.1747, 0.2112, 0.2850],
        'F1_std': [0.0400, 0.0612, 0.0114, 0.0497, 0.0641],
        'QWK_mean': [0.0428, 0.0724, 0.1241, 0.1537, 0.0614],
        'QWK_std': [0.1468, 0.1261, 0.1749, 0.0717, 0.1228]
    }
    
    df = pd.DataFrame(results)
    
    print("ğŸ“Š ì„±ëŠ¥ ì§€í‘œ ìš”ì•½ (5-fold Cross Validation)")
    print("=" * 80)
    print(f"{'Target':<15} {'MAE':<12} {'RÂ²':<12} {'Accuracy':<12} {'F1':<12} {'QWK':<12}")
    print("-" * 80)
    
    for _, row in df.iterrows():
        mae_str = f"{row['MAE_mean']:.3f}Â±{row['MAE_std']:.3f}"
        r2_str = f"{row['R2_mean']:.3f}Â±{row['R2_std']:.3f}"
        acc_str = f"{row['ACC_mean']:.3f}Â±{row['ACC_std']:.3f}"
        f1_str = f"{row['F1_mean']:.3f}Â±{row['F1_std']:.3f}"
        qwk_str = f"{row['QWK_mean']:.3f}Â±{row['QWK_std']:.3f}"
        
        print(f"{row['Target']:<15} {mae_str:<12} {r2_str:<12} {acc_str:<12} {f1_str:<12} {qwk_str:<12}")
    
    # ì „ì²´ í‰ê°€
    print("\n" + "=" * 80)
    print("ğŸ“ˆ ì „ì²´ ì„±ëŠ¥ ë¶„ì„")
    print("=" * 80)
    
    avg_r2 = df['R2_mean'].mean()
    avg_acc = df['ACC_mean'].mean()
    avg_f1 = df['F1_mean'].mean()
    avg_qwk = df['QWK_mean'].mean()
    
    print(f"í‰ê·  RÂ²: {avg_r2:.4f}")
    print(f"í‰ê·  ì •í™•ë„: {avg_acc:.4f}")
    print(f"í‰ê·  F1 ì ìˆ˜: {avg_f1:.4f}")
    print(f"í‰ê·  QWK: {avg_qwk:.4f}")
    
    # ìµœê³ /ìµœì € ì„±ëŠ¥
    best_target = df.loc[df['R2_mean'].idxmax(), 'Target']
    worst_target = df.loc[df['R2_mean'].idxmin(), 'Target']
    
    print(f"\nğŸ† ìµœê³  ì„±ëŠ¥ íƒ€ê²Ÿ: {best_target} (RÂ² = {df['R2_mean'].max():.4f})")
    print(f"ğŸ“‰ ìµœì € ì„±ëŠ¥ íƒ€ê²Ÿ: {worst_target} (RÂ² = {df['R2_mean'].min():.4f})")
    
    # ì„±ëŠ¥ í•´ì„
    print("\n" + "=" * 80)
    print("ğŸ” ì„±ëŠ¥ í•´ì„")
    print("=" * 80)
    
    print("ì£¼ìš” ê´€ì°° ì‚¬í•­:")
    print("1. ëª¨ë“  íƒ€ê²Ÿì—ì„œ RÂ² ê°’ì´ ìŒìˆ˜ ë˜ëŠ” 0ì— ê°€ê¹Œì›€ â†’ ì˜ˆì¸¡ ì„±ëŠ¥ì´ ë§¤ìš° ë‚®ìŒ")
    print("2. ì •í™•ë„ëŠ” 40-48% ìˆ˜ì¤€ â†’ ëœë¤ ì¶”ì¸¡ë³´ë‹¤ ì•½ê°„ ë‚˜ì€ ìˆ˜ì¤€")
    print("3. F1 ì ìˆ˜ê°€ 0.17-0.28ë¡œ ë‚®ìŒ â†’ í´ë˜ìŠ¤ ë¶ˆê· í˜• ë¬¸ì œ")
    print("4. QWK(Quadratic Weighted Kappa)ê°€ ë‚®ìŒ â†’ ìˆœì„œí˜• ì˜ˆì¸¡ ì„±ëŠ¥ ë¶€ì¡±")
    
    print("\nê°€ëŠ¥í•œ ì›ì¸ ë¶„ì„:")
    print("â€¢ ë°ì´í„° í¬ê¸°: 150ê°œ ìƒ˜í”Œì€ 1536ì°¨ì› íŠ¹ì„±ì— ë¹„í•´ ë§¤ìš° ì‘ìŒ (ì°¨ì›ì˜ ì €ì£¼)")
    print("â€¢ íŠ¹ì„± í’ˆì§ˆ: ViT íŠ¹ì„±ì´ ì´ ë„ë©”ì¸ì˜ í’ˆì§ˆ í‰ê°€ì— ì í•©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ")
    print("â€¢ íƒ€ê²Ÿ ë¶„í¬: í´ë˜ìŠ¤ê°€ ë¶ˆê· í˜•í•˜ê±°ë‚˜ ë³€ë³„ë ¥ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŒ")
    print("â€¢ ì˜¤ë²„í”¼íŒ…: ê³ ì°¨ì› ë°ì´í„°ì—ì„œ ì†Œê·œëª¨ ë°ì´í„°ë¡œ ì¸í•œ ì¼ë°˜í™” ë¶€ì¡±")
    
    print("\nğŸ’¡ ê°œì„  ë°©ì•ˆ ì œì•ˆ:")
    print("1. ì°¨ì› ì¶•ì†Œ: PCA ë˜ëŠ” íŠ¹ì„± ì„ íƒìœ¼ë¡œ ì°¨ì› ì¤„ì´ê¸°")
    print("2. ë°ì´í„° ì¦ê°•: ë” ë§ì€ ë°ì´í„° ìˆ˜ì§‘ ë˜ëŠ” ì¦ê°• ê¸°ë²• ì ìš©")
    print("3. íŠ¹ì„± ì—”ì§€ë‹ˆì–´ë§: ë„ë©”ì¸ íŠ¹í™” íŠ¹ì„± ì¶”ì¶œ")
    print("4. ëª¨ë¸ ì •ê·œí™”: L1/L2 ì •ê·œí™”, ë“œë¡­ì•„ì›ƒ ë“±ìœ¼ë¡œ ì˜¤ë²„í”¼íŒ… ë°©ì§€")
    print("5. ì•™ìƒë¸” ë°©ë²•: ë‹¤ì–‘í•œ ëª¨ë¸ ì¡°í•©ìœ¼ë¡œ ì„±ëŠ¥ í–¥ìƒ")
    
    # ì´ì „ ê²°ê³¼ì™€ ë¹„êµ (ì¤‘ë³µ ì œê±° ì „í›„)
    print("\n" + "=" * 80)
    print("ğŸ“‹ ì¤‘ë³µ ì œê±° íš¨ê³¼")
    print("=" * 80)
    print("âœ… ë°ì´í„° í’ˆì§ˆ ê°œì„ :")
    print(f"  - ì¤‘ë³µ ì œê±°: 465ê°œ â†’ 150ê°œ ìƒ˜í”Œ (315ê°œ ì¤‘ë³µ ì œê±°)")
    print(f"  - ëª¨ë“  record_keyê°€ ê³ ìœ í•¨ í™•ì¸")
    print(f"  - ê³¼ì í•©ìœ¼ë¡œ ì¸í•œ ì˜ëª»ëœ ê³ ì„±ëŠ¥ ì œê±°")
    
    print("\nğŸ¯ í˜„ì‹¤ì ì¸ ì„±ëŠ¥ ì¸¡ì •:")
    print("  - ì´ì „: ì¸ìœ„ì ìœ¼ë¡œ ë†’ì€ ì ìˆ˜ (ì¤‘ë³µ ë°ì´í„°ë¡œ ì¸í•œ ì°©ì‹œ)")
    print("  - í˜„ì¬: ì‹¤ì œ ëª¨ë¸ì˜ ì¼ë°˜í™” ì„±ëŠ¥ ë°˜ì˜")
    print("  - ëª¨ë¸ ê°œì„ ì˜ ì •í™•í•œ ë°©í–¥ ì œì‹œ ê°€ëŠ¥")
    
    # CSVë¡œ ì €ì¥
    df.to_csv("performance_summary_cleaned.csv", index=False)
    print(f"\nğŸ“„ ê²°ê³¼ê°€ 'performance_summary_cleaned.csv'ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")

if __name__ == "__main__":
    main()